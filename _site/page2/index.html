<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <link href="http://gmpg.org/xfn/11" rel="profile">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      msdalp &middot; java, android, etc.
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/atom+xml" title="msdalp" href="/atom.xml">
</head>


  <body>

    <div class="container content">
      <header class="masthead">
      <h3 class="masthead-title">
<a href="/" title="Home">msdalp</a>
<small>java, android, etc.</small>

  &nbsp;&nbsp;&nbsp;
  <small><a href="/about">About</a></small>

  &nbsp;&nbsp;&nbsp;
  <small><a href="/archive">Archive</a></small>

  &nbsp;&nbsp;&nbsp;
  <small><a href="/atom.xml">Feed</a></small>


</h3>

      </header>

      <main>
        <div class="posts">
  
  <article class="post">
    <h1 class="post-title">
      <a href="/2015/07/13/Tomcat-Setenv-sh/">
        Configuring Tomcat SetEnv File
      </a>
    </h1>

    <time datetime="2015-07-13T23:39:22+03:00" class="post-date">13 Jul 2015</time>

    <blockquote>
  <p>Very specific details about the set env details.</p>
</blockquote>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#! /bin/sh</span>
<span class="c"># ==================================================================</span>
<span class="c">#  ______                           __     _____</span>
<span class="c"># /_  __/___  ____ ___  _________ _/ /_   /__  /</span>
<span class="c">#  / / / __ \/ __ `__ \/ ___/ __ `/ __/     / /</span>
<span class="c"># / / / /_/ / / / / / / /__/ /_/ / /_      / /</span>
<span class="c">#/_/  \____/_/ /_/ /_/\___/\__,_/\__/     /_/</span>

<span class="c"># Multi-instance Apache Tomcat installation with a focus</span>
<span class="c"># on best-practices as defined by Apache, SpringSource, and MuleSoft</span>
<span class="c"># and enterprise use with large-scale deployments.</span>

<span class="c"># Credits:</span>
<span class="c">#       Google -&gt; Couldn&#39;t survive without it</span>
<span class="c">#       Stackoverflow.com -&gt; Community support</span>
<span class="c">#       SpringSource -&gt; Specifically best-practices and seminars (Expert Series)</span>

<span class="c"># Based On:</span>
<span class="c">#       http://www.springsource.com/files/uploads/tomcat/tomcatx-performance-tuning.pdf</span>
<span class="c">#       http://www.springsource.com/files/u1/PerformanceTuningApacheTomcat-Part2.pdf</span>
<span class="c">#       http://www.springsource.com/files/uploads/tomcat/tomcatx-large-scale-deployments.pdf</span>

<span class="c"># Created By: Terrance A. Snyder</span>
<span class="c"># URL: http://www.terranceasnyder.com, http://shutupandcode.net</span>

<span class="c"># Best Practice Documentation:</span>
<span class="c"># http://terranceasnyder.com/2011/05/tomcat-best-practices/</span>

<span class="c"># Looking for the latest version?</span>
<span class="c"># github @ https://github.com/terrancesnyder</span>

<span class="c"># ==================================================================</span>

<span class="c"># discourage address map swapping by setting Xms and Xmx to the same value</span>
<span class="c"># http://confluence.atlassian.com/display/DOC/Garbage+Collector+Performance+Issues</span>
<span class="nb">export </span><span class="nv">CATALINA_OPTS</span><span class="o">=</span><span class="s2">&quot;$CATALINA_OPTS -Xms64m&quot;</span>
<span class="nb">export </span><span class="nv">CATALINA_OPTS</span><span class="o">=</span><span class="s2">&quot;$CATALINA_OPTS -Xmx512m&quot;</span>

<span class="c"># Increase maximum perm size for web base applications to 4x the default amount</span>
<span class="c"># http://wiki.apache.org/tomcat/FAQ/Memoryhttp://wiki.apache.org/tomcat/FAQ/Memory</span>
<span class="nb">export </span><span class="nv">CATALINA_OPTS</span><span class="o">=</span><span class="s2">&quot;$CATALINA_OPTS -XX:MaxPermSize=256m&quot;</span>

<span class="c"># Reset the default stack size for threads to a lower value (by 1/10th original)</span>
<span class="c"># By default this can be anywhere between 512k -&gt; 1024k depending on x32 or x64</span>
<span class="c"># bit Java version.</span>
<span class="c"># http://www.springsource.com/files/uploads/tomcat/tomcatx-large-scale-deployments.pdf</span>
<span class="c"># http://www.oracle.com/technetwork/java/hotspotfaq-138619.html</span>
<span class="nb">export </span><span class="nv">CATALINA_OPTS</span><span class="o">=</span><span class="s2">&quot;$CATALINA_OPTS -Xss192k&quot;</span>

<span class="c"># Oracle Java as default, uses the serial garbage collector on the</span>
<span class="c"># Full Tenured heap. The Young space is collected in parallel, but the</span>
<span class="c"># Tenured is not. This means that at a time of load if a full collection</span>
<span class="c"># event occurs, since the event is a &#39;stop-the-world&#39; serial event then</span>
<span class="c"># all application threads other than the garbage collector thread are</span>
<span class="c"># taken off the CPU. This can have severe consequences if requests continue</span>
<span class="c"># to accrue during these &#39;outage&#39; periods. (specifically webservices, webapps)</span>
<span class="c"># [Also enables adaptive sizing automatically]</span>
<span class="nb">export </span><span class="nv">CATALINA_OPTS</span><span class="o">=</span><span class="s2">&quot;$CATALINA_OPTS -XX:+UseParallelGC&quot;</span>

<span class="c"># This is interpreted as a hint to the garbage collector that pause times</span>
<span class="c"># of &lt;nnn&gt; milliseconds or less are desired. The garbage collector will</span>
<span class="c"># adjust the  Java heap size and other garbage collection related parameters</span>
<span class="c"># in an attempt to keep garbage collection pauses shorter than &lt;nnn&gt; milliseconds.</span>
<span class="c"># http://java.sun.com/docs/hotspot/gc5.0/ergo5.html</span>
<span class="nb">export </span><span class="nv">CATALINA_OPTS</span><span class="o">=</span><span class="s2">&quot;$CATALINA_OPTS -XX:MaxGCPauseMillis=1500&quot;</span>

<span class="c"># A hint to the virtual machine that it.s desirable that not more than:</span>
<span class="c"># 1 / (1 + GCTimeRation) of the application execution time be spent in</span>
<span class="c"># the garbage collector.</span>
<span class="c"># http://themindstorms.wordpress.com/2009/01/21/advanced-jvm-tuning-for-low-pause/</span>
<span class="nb">export </span><span class="nv">CATALINA_OPTS</span><span class="o">=</span><span class="s2">&quot;$CATALINA_OPTS -XX:GCTimeRatio=9&quot;</span>

<span class="c"># The hotspot server JVM has specific code-path optimizations</span>
<span class="c"># which yield an approximate 10% gain over the client version.</span>
<span class="nb">export </span><span class="nv">CATALINA_OPTS</span><span class="o">=</span><span class="s2">&quot;$CATALINA_OPTS -server&quot;</span>

<span class="c"># Disable remote (distributed) garbage collection by Java clients</span>
<span class="c"># and remove ability for applications to call explicit GC collection</span>
<span class="nb">export </span><span class="nv">CATALINA_OPTS</span><span class="o">=</span><span class="s2">&quot;$CATALINA_OPTS -XX:+DisableExplicitGC&quot;</span>

<span class="c"># Check for application specific parameters at startup</span>
<span class="k">if</span> <span class="o">[</span> -r <span class="s2">&quot;$CATALINA_BASE/bin/appenv.sh&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  . <span class="s2">&quot;$CATALINA_BASE/bin/appenv.sh&quot;</span>
<span class="k">fi</span>

<span class="nb">echo</span> <span class="s2">&quot;Using CATALINA_OPTS:&quot;</span>
<span class="k">for</span> arg in <span class="nv">$CATALINA_OPTS</span>
<span class="k">do</span>
    <span class="nb">echo</span> <span class="s2">&quot;&gt;&gt; &quot;</span> <span class="nv">$arg</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="s2">&quot;&quot;</span>

<span class="nb">echo</span> <span class="s2">&quot;Using JAVA_OPTS:&quot;</span>
<span class="k">for</span> arg in <span class="nv">$JAVA_OPTS</span>
<span class="k">do</span>
    <span class="nb">echo</span> <span class="s2">&quot;&gt;&gt; &quot;</span> <span class="nv">$arg</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="s2">&quot;_______________________________________________&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;&quot;</span></code></pre></div>


  </article>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page3">Older</a>
  
  
    
      <a class="pagination-item newer" href="/">Newer</a>
    
  
</div>


      </main>
      <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    // Required: on line below, replace text in quotes with your forum shortname
    var disqus_shortname = 'msdalp';
    // var disqus_developer = 1;

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

      <footer class="footer">
        <small>
          &copy; <time datetime="2016-04-03T16:49:20+03:00">2016</time>. All rights reserved.
        </small>
      </footer>
    </div>

  </body>
</html>
