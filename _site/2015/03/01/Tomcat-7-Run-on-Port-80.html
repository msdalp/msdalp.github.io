<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Run Tomcat7 on Port 80</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">msdalp's spot</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>Run Tomcat7 on Port 80</h2>
<p class="meta">01 Mar 2015</p>

<div class="post">
<p>You may need to run Tomcat on port 80 for many reasons. It is possible to accomplish this in three steps. <br>
First step is move 8080 to port 80.Find your server.xml file for Tomcat. It is probably under /etc/tomcat/server.xml but still 
you can find it by using: <br></p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>locate server.xml
/etc/tomcat7/server.xml</code></pre></div>

<p>Open server.xml file with an avaliable text editor (I will use nano).</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>sudo nano /etc/tomcat7/server.xml</code></pre></div>

<p>Find the part where port is defined as 8080 and change it to 80.</p>

<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;Connector</span> <span class="na">port=</span><span class="s">&quot;80&quot;</span> <span class="na">protocol=</span><span class="s">&quot;HTTP/1.1&quot;</span>
               <span class="na">connectionTimeout=</span><span class="s">&quot;20000&quot;</span>
               <span class="na">URIEncoding=</span><span class="s">&quot;UTF-8&quot;</span>
               <span class="na">redirectPort=</span><span class="s">&quot;8443&quot;</span> <span class="nt">/&gt;</span></code></pre></div>

<p>Close the file by saving it. If you run tomcat now it will complain about some authentication errors. It happens because we are trying to run 
Tomcat under 1023 ports. So the next step is enable authbind for tomcat. If you run Tomcat on port numbers that are all higher than 1023, then you
 do not need authbind.  It is used for binding Tomcat to lower port numbers. Open /etc/default/tomcat with your text editor.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>sudo nano /etc/default/tomcat7</code></pre></div>

<p>Switch authbind=no to authbind=yes which is located at the end of file.</p>

<div class="highlight"><pre><code class="language-xml" data-lang="xml"># NOTE: authbind works only with IPv4.  Do not enable it when using IPv6.
# (yes/no, default: no)
AUTHBIND=yes</code></pre></div>

<p>The last step is disabling IPv6. You can see the warning just before authbind line saying that &quot;NOTE: authbind works only with IPv4.  Do not enable it when using IPv6.&quot;.
Open /etc/sysctl.conf with your text editor.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>sudo nano /etc/sysctl.conf</code></pre></div>

<p>And add these three lines to end of the file.</p>

<div class="highlight"><pre><code class="language-xml" data-lang="xml">net.ipv6.conf.all.disable_ipv6 = 1
net.ipv6.conf.default.disable_ipv6 = 1
net.ipv6.conf.lo.disable_ipv6 = 1</code></pre></div>

<p>Save the file and close it. To make sure IPv6 is disabled run </p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">sudo sysctl -p</code></pre></div>

<p>and you will see </p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">net.ipv6.conf.all.disable_ipv6 <span class="o">=</span> 1
net.ipv6.conf.default.disable_ipv6 <span class="o">=</span> 1
net.ipv6.conf.lo.disable_ipv6 <span class="o">=</span> 1</code></pre></div>

<p>After that, if you run:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>cat /proc/sys/net/ipv6/conf/all/disable_ipv6</code></pre></div>

<p>It will report: 1 <br>
Now it is ready to run on port 80. Start your tomcat with </p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>sudo service tomcat7 start</code></pre></div>

<p>If you look at your catalina.out logs it will be written in there as </p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">Mar 21, <span class="m">2015</span> 10:02:44 PM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler <span class="o">[</span><span class="s2">&quot;http-bio-80&quot;</span><span class="o">]</span></code></pre></div>

<p>Now you can access your services directly without any port like <br>
example.com/Services/</p>

</div>


          <div class="footer">
            <div class="contact">
              <p>
                Mustafa Alparslan<br />
                Comp. Eng. Student<br />
                msdalp(at)gmail(dot)com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/msdalp">github.com/msdalp</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
